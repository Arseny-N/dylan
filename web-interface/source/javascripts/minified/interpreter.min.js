!function(app){app.Interpreter=function(e){_.extend(this,e)},app.Interpreter.prototype.find_runtime_lib=function(e){var t=this.docs.where({name:e});return t&&t.length?t[0]:e.match(/.js$/)?void 0:(e+=".js",t=this.docs.where({name:e}),t.length?t[0]:void 0)},app.Interpreter.prototype.get_runtime_lib=function(e,t){var r,_=this.find_runtime_lib(e);return _?(r=this.execute(_),r.rv&&this.log("interpreter:get_runtime_lib",t,"Failed to load "+e+", non null return value("+this.pretty_string(r.rv)+")","error"),r.exports):void 0},app.Interpreter.prototype.ctx_setup=function(e,t,r){e.self=this,e.required_libs={},e.libs=this.libs,e.libs.logger=app.libs.gen_logger(t),e.libs.documents=app.libs.gen_docs(this.docs),e.docs=this.docs;var _="",i="";for(var n in r){var o=r[n],s=o;"object"==typeof o&&(s=o.as,o=o.lib),_+=", "+s,i+=", this.libs."+o}e.eval_str={},e.eval_str.start=";(function ___main___(require, exports, __filename"+_+") { \n",e.eval_str.end=" \n;})(require, exports, __filename"+i+");",e.eval_str.abort=""},app.Interpreter.prototype.execute=function(__document__,__context__){function require(e){var t=__context__.libs[e];if(t)return __context__.required_libs[e]=t,t;var r=exports;if(t=__context__.self.get_runtime_lib(e,__filename),exports=r,t)return __context__.required_libs[e]=t,t;throw __context__.self.log("interpreter:require",__filename,"Library "+e+" not found."),{name:"NoLibraryFound",text:'no library "'+e+'" found.'}}function required(e,t,r){__context__.required_libs&&__context__.required_libs[e]&&f()||r()}function exit(e){throw{name:"ExitExeption",status:e}}function _ex(string){var str=this.eval_str.abort+this.eval_str.start+string+this.eval_str.end;return eval(str)}var __exeption__=void 0,__filename=__document__.get&&__document__.get("name")||"console",__filedata=__document__.get&&__document__.get("data")||__document__;this.rv=void 0,__context__||this.ctx_setup(__context__={},__filename),exports={},"console"!=__filename&&this.log("interpreter:execute",__filename,'Started script "'+__filename+'" execution.');try{this.rv=_ex.call(__context__,__filedata),console.log(this.rv)}catch(__exeption__){switch(__exeption__.name){case"ExitExeption":this.rv=__exeption__.status;break;default:this.log("interpreter:execute",__filename,'Script "'+__filename+'" aborted execution. ',"error"),this.log("interpreter:execute",__filename,"Exeption: "+this.pretty_string(__exeption__)+".","error"),this.log("interpreter:execute",__filename,"Stack:"+__exeption__.stack)}}return __exeption__||"console"==__filename||(this.log("interpreter:execute",__filename,'Script "'+__filename+'" exited.'),this.rv&&this.log("interpreter:execute",__filename,"Return value: "+this.pretty_string(this.rv)),this.log("interpreter:execute",__filename,"Exporting: "+this.pretty_string(exports))),"console"==__filename&&this.rv&&this.log("interpreter:execute",__filename,this.pretty_string(this.rv)),{status:this.rv,exports:exports}},app.Interpreter.prototype.pretty_string=function(e){return console.dir(e),app.utils.object2string(e)}}(app);